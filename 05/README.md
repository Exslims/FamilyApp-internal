# FamilyApp-internal

### Описание

Тема: Бытовой помощник (учет финансов). 

Будет основан на модульной архитектуре, где первым модулем будет **учет финансов** (запись, аналитика, прогнозирование и тп). 

### Описание бизнес кейсов


В системе заводится пользователь. Пользователь может создать кошелек, либо присоедениться к существующему кошельку, который был создан другим пользователем. Пользователь может иметь несколько кошельков, так же как и кошелек может быть общим на несколько юзеров, но владелец только 1. Для пользователя устанавливается определенна роль для кошелька (RO/ RW). 

На главном экране приложения пользователь видит сводку которая включает в себя отображение баланса, списка транзакций сгруппированных по категориям (по убыванию суммы).

Пользователь может получить список транзакций сгруппированных по категориям за определенный период с суммой под каждой категорией.

Пользователь может добавлять/обновлять/удалять транзакции внутри кошелька.

Пользователь может получить список транзакций сгруппированных по дням за определенный период.

Пользователь может получить список транзакций по категории за определенный период. 

Пользователь может настраивать(добавлять/удалять) категории внутри кошелька, категории относятся только к одному кошельку.

Категории можно объеденять под тегами. Одна категория может быть под несколькими тегами, так же и теги могут иметь категории у которых уже есть теги. Пользователь может создавать/обновлять/удалять теги.

Пользователь может добавлять/обновлять/удалять бюджеты. Бюджет устанавливает определенную границу на группу категорий. Категории могут относиться к нескольким бюджетам. 

В списке бюджетов пользователь видит список с суммой транзакций которые попали в бюджет.

### Схема
![image](https://user-images.githubusercontent.com/11871586/176472681-a2359e06-12e1-4ab7-bb52-3d93fdefbe7e.png)

### Индексы

#### Примеры запросов

1. Создать юзера, обновить данные юзера. 
2. Получить список юзеров кошелька.
3. Создать кошелек, обновить данные кошелька.
4. Получить список кошельков по юзеру. 
5. Добавить, удалить юзера из кошелька.
6. Создать, удалить роль.
7. Получить список ролей.
8. Указать роль юзера для кошелька
9. Создать, обновить, удалить категорию. 
10. Получить список транзакций кошелька за период и сгруппировать по дням и категориям. 
11. Получить баланс кошелька, обновить баланс кошелька.
12. Создать, обновить, удалить бюджет.
13. Получить список бюджетов для кошелька, в которых будет указана сумма транзакций за период.
14. Получить список транзакций по бюджету за определенный период.
15. Добавить, удалить, обновить тег.
16. Получить список категорий по тегу. 
17. Получить список транзакций кошелька за период, по тегу, и сгруппировать по дням и категориям.

#### Описание индексов (без учета индексов которые создаются автоматически)

1. CREATE INDEX idx_transactions_list_wallet_id_category_id_transactions_date ON transactions(wallet_id, category_id, transaction_date);
   1. Нужно будет часто загружать/группировать транзакции по определенному периоду и категориям(день/неделя/месяц) определенного кошелька.
2. CREATE INDEX idx_get_user_wallets_user_id ON users_wallets(user_id);
   1. Нужно будет получать список кошельков у которых владелец/приглашенный указанный юзер. 
3. CREATE INDEX idx_get_users_wallet_wallet_id ON users_wallets(wallet_id);
   1. Нужно будет получать список юзеров по кошельку
4. CREATE INDEX idx_get_categories_budget_id ON categories_budgets(budget_id);
   1. Будет использован в кейсе когда нужно подгрузить транзакции по бюджету(в текущей схеме это будет сделано через категории)


